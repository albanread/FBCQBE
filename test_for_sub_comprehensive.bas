10 REM Comprehensive FOR in SUB test - all major features
20 PRINT "=== FOR Loop in SUB Comprehensive Tests ==="
30 PRINT ""
40 CALL Test1
50 CALL Test2
60 CALL Test3
70 CALL Test4
80 CALL Test5
90 CALL Test6
100 PRINT ""
110 PRINT "=== All FOR in SUB Tests PASSED ==="
120 END
130
140 SUB Test1()
150   PRINT "Test 1: Basic FOR 1 TO 5"
160   LOCAL SUM AS INTEGER
170   SUM = 0
180   FOR I = 1 TO 5
190     PRINT I;
200     SUM = SUM + I
210   NEXT I
220   PRINT ""
230   IF SUM = 15 THEN PRINT "PASS" ELSE PRINT "FAIL"
240   PRINT ""
250 END SUB
260
270 SUB Test2()
280   PRINT "Test 2: FOR with STEP 2"
290   LOCAL COUNT AS INTEGER
300   COUNT = 0
310   FOR J = 1 TO 10 STEP 2
320     PRINT J;
330     COUNT = COUNT + 1
340   NEXT J
350   PRINT ""
360   IF COUNT = 5 THEN PRINT "PASS" ELSE PRINT "FAIL"
370   PRINT ""
380 END SUB
390
400 SUB Test3()
410   PRINT "Test 3: FOR countdown STEP -1"
420   LOCAL SUM AS INTEGER
430   SUM = 0
440   FOR K = 10 TO 1 STEP -1
450     PRINT K;
460     SUM = SUM + K
470   NEXT K
480   PRINT ""
490   IF SUM = 55 THEN PRINT "PASS" ELSE PRINT "FAIL"
500   PRINT ""
510 END SUB
520
530 SUB Test4()
540   PRINT "Test 4: Nested FOR loops"
550   LOCAL TOTAL AS INTEGER
560   LOCAL PROD AS INTEGER
570   TOTAL = 0
580   FOR P = 1 TO 3
590     FOR Q = 1 TO 3
600       PROD = P * Q
610       PRINT PROD;
620       TOTAL = TOTAL + PROD
630     NEXT Q
640     PRINT ""
650   NEXT P
660   IF TOTAL = 36 THEN PRINT "PASS" ELSE PRINT "FAIL"
670   PRINT ""
680 END SUB
690
700 SUB Test5()
710   PRINT "Test 5: EXIT FOR at 3"
720   LOCAL COUNT AS INTEGER
730   COUNT = 0
740   FOR S = 1 TO 10
750     PRINT S;
760     COUNT = COUNT + 1
770     IF S = 3 THEN EXIT FOR
780   NEXT S
790   PRINT ""
800   IF COUNT = 3 THEN PRINT "PASS" ELSE PRINT "FAIL"
810   PRINT ""
820 END SUB
830
840 SUB Test6()
850   PRINT "Test 6: Large range 1 TO 100"
860   LOCAL BIGSUM AS INTEGER
870   BIGSUM = 0
880   FOR T = 1 TO 100
890     BIGSUM = BIGSUM + T
900   NEXT T
910   PRINT "Sum = "; BIGSUM
920   IF BIGSUM = 5050 THEN PRINT "PASS" ELSE PRINT "FAIL"
930   PRINT ""
940 END SUB
